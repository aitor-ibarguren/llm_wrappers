============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /home/runner/work/llm_wrappers/llm_wrappers
plugins: langsmith-0.4.56, anyio-4.12.0, cov-7.0.0
collected 35 items

tests/test_bart_wrapper.py ......                                        [ 17%]
tests/test_faiss_wrapper.py ...........                                  [ 48%]
tests/test_flan_t5_wrapper.py ......                                     [ 65%]
tests/test_gpt2_wrapper.py ......                                        [ 82%]
tests/test_qwen_wrapper.py ......                                        [100%]

=============================== warnings summary ===============================
<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyPacked has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type SwigPyObject has no __module__ attribute

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: builtin type swigvarlink has no __module__ attribute

tests/test_bart_wrapper.py::TestBARTWrapper::test_peft_train_model
tests/test_bart_wrapper.py::TestBARTWrapper::test_train_model
tests/test_flan_t5_wrapper.py::TestFlanT5Wrapper::test_peft_train_model
tests/test_flan_t5_wrapper.py::TestFlanT5Wrapper::test_train_model
tests/test_gpt2_wrapper.py::TestFlanT5Wrapper::test_peft_train_model
tests/test_gpt2_wrapper.py::TestFlanT5Wrapper::test_train_model
tests/test_qwen_wrapper.py::TestQwenWrapper::test_peft_train_model
tests/test_qwen_wrapper.py::TestQwenWrapper::test_train_model
  /opt/hostedtoolcache/Python/3.12.12/x64/lib/python3.12/site-packages/torch/utils/data/dataloader.py:668: UserWarning: 'pin_memory' argument is set as true but no accelerator is found, then device pinned memory won't be used.
    warnings.warn(warn_msg)

tests/test_bart_wrapper.py::TestBARTWrapper::test_save_and_load_model
tests/test_bart_wrapper.py::TestBARTWrapper::test_train_model
  /opt/hostedtoolcache/Python/3.12.12/x64/lib/python3.12/site-packages/transformers/modeling_utils.py:3918: UserWarning: Moving the following attributes in the config to the generation config: {'early_stopping': True, 'num_beams': 4, 'no_repeat_ngram_size': 3, 'forced_bos_token_id': 0}. You are seeing this warning because you've set generation parameters in the model config, as opposed to in the generation config.
    warnings.warn(

tests/test_bart_wrapper.py::TestBARTWrapper::test_train_model
  /home/runner/work/llm_wrappers/llm_wrappers/bart_wrapper/bart_wrapper.py:305: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
    trainer = Seq2SeqTrainer(

tests/test_flan_t5_wrapper.py::TestFlanT5Wrapper::test_train_model
  /home/runner/work/llm_wrappers/llm_wrappers/flan_t5_wrapper/flan_t5_wrapper.py:302: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Seq2SeqTrainer.__init__`. Use `processing_class` instead.
    trainer = Seq2SeqTrainer(

tests/test_gpt2_wrapper.py::TestFlanT5Wrapper::test_peft_train_model
  /opt/hostedtoolcache/Python/3.12.12/x64/lib/python3.12/site-packages/peft/tuners/lora/layer.py:2285: UserWarning: fan_in_fan_out is set to False but the target module is `Conv1D`. Setting fan_in_fan_out to True.
    warnings.warn(

tests/test_gpt2_wrapper.py::TestFlanT5Wrapper::test_train_model
  /home/runner/work/llm_wrappers/llm_wrappers/gpt2_wrapper/gpt2_wrapper.py:316: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
    trainer = Trainer(

tests/test_qwen_wrapper.py::TestQwenWrapper::test_train_model
  /home/runner/work/llm_wrappers/llm_wrappers/qwen_wrapper/qwen_wrapper.py:316: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
    trainer = Trainer(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                                 Stmts   Miss  Cover   Missing
------------------------------------------------------------------
bart_wrapper/__init__.py                 0      0   100%
bart_wrapper/bart_wrapper.py           153     12    92%   35-37, 58, 88-90, 94, 126-128, 135
faiss_wrapper/__init__.py                0      0   100%
faiss_wrapper/faiss_wrapper.py         389     41    89%   87, 132-136, 149-151, 155-158, 165-167, 257-266, 402, 428-435, 454-455, 529-530, 534, 606-607, 612-613, 654-655, 662-663, 742-744, 746-748
flan_t5_wrapper/__init__.py              0      0   100%
flan_t5_wrapper/flan_t5_wrapper.py     156     12    92%   41-43, 64, 94-96, 100, 132-134, 141
gpt2_wrapper/__init__.py                 0      0   100%
gpt2_wrapper/gpt2_wrapper.py           157     12    92%   38-40, 63, 93-95, 99, 131-133, 140
qwen_wrapper/__init__.py                 0      0   100%
qwen_wrapper/qwen_wrapper.py           157     12    92%   43-45, 66, 96-98, 102, 134-136, 143
setup.py                                 2      2     0%   1-3
tests/__init__.py                        0      0   100%
tests/test_bart_wrapper.py              69      2    97%   6, 131
tests/test_faiss_wrapper.py            120      2    98%   6, 244
tests/test_flan_t5_wrapper.py           69      2    97%   6, 131
tests/test_gpt2_wrapper.py              69      2    97%   6, 134
tests/test_qwen_wrapper.py              69      2    97%   6, 131
------------------------------------------------------------------
TOTAL                                 1410    101    93%
================= 35 passed, 18 warnings in 379.98s (0:06:19) ==================
